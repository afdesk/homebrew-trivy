# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/afdesk/trivy"
  version "0.43.0"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/afdesk/trivy/releases/download/v0.43.0/trivy_0.43.0_macOS-64bit.tar.gz"
      sha256 "3923f90f99b0c339b4c17e5325061b64096d09a6db96d166046bbddf4f8ee1a5"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/afdesk/trivy/releases/download/v0.43.0/trivy_0.43.0_macOS-ARM64.tar.gz"
      sha256 "4abf8251465fe0a7b6367bb8d578004a003c809c7795447358f52f4147edccfc"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/afdesk/trivy/releases/download/v0.43.0/trivy_0.43.0_Linux-64bit.tar.gz"
      sha256 "491c37ca238c9584785d6f9928bce0d678335956398e7900af1f8bca907c6437"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/afdesk/trivy/releases/download/v0.43.0/trivy_0.43.0_Linux-ARM64.tar.gz"
      sha256 "74d1a6f29ec22d3a3fb8620a7ff8ccf169683ba70b8d560b7d3aad6b9159c8f6"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
